/**
 * Copyright 2012-2020 | Fabrice Creuzot (luigifab) <code~luigifab~fr>
 * https://www.luigifab.fr/openmage/modules
 * This program is free software, you can redistribute it or modify
 * it under the terms of the GNU General Public License (GPL).
 */
window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t,o){for(t=t||window,o=0;o<this.length;o++)e.call(t,this[o],o,this)});var modules=new function(){"use strict";this.start=function(){var t,e;document.querySelector("body.adminhtml-modules-index-index")&&(console.info("modules.app - hello"),document.querySelectorAll("table.data tr.filter th").forEach(function(e){for(;0<e.childNodes.length;)e.removeChild(e.firstChild);(t=document.createElement("input")).setAttribute("type","search"),t.setAttribute("spellcheck","false"),t.setAttribute("autocomplete","off"),t.setAttribute("class","input-text"),t.setAttribute("oninput","modules.action('"+e.parentNode.parentNode.parentNode.getAttribute("id")+"');"),e.appendChild(t)}),(e=this.storage("modules_search"))&&((t=document.querySelector('div.content-header input[type="search"]')).value=e,this.action(t)))},this.filter=function(e){var r,l,i,n,s,a;document.getElementById(e).querySelectorAll("tbody tr").forEach(function(o){n=[],document.getElementById(e).querySelectorAll('input[type="search"]').forEach(function(e,t){0<(r=e.value.toLowerCase().trim()).length?(r=r.split(" "),s=r.length,i=o.querySelectorAll("td")[t].innerHTML.replace(/<[^>]+>/gi,"").toLowerCase().trim(),a=0,r.forEach(function(e){if("-"===e||"|"===e)s--;else if("-"===e.charAt(0))s--,-1<i.indexOf(e.substr(1))&&(s=-1);else if(-1<e.indexOf("|"))for(l=e.split("|");0<l.length;)0<(e=l.pop()).length&&-1<i.indexOf(e)&&(l="",a++);else-1<i.indexOf(e)&&a++}),n.push(a===s)):n.push(!0)}),o.setAttribute("style",-1<n.indexOf(!1)?"display:none;":""),o.removeAttribute("title")})},this.action=function(t){if("string"!=typeof t){if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return;document.querySelectorAll("table.data").forEach(function(e){e.querySelector('input[type="search"]').value=t.value,this.filter(e.getAttribute("id"))},this),this.storage("modules_search",t.value)}else document.getElementById(t)&&this.filter(t)},this.reset=function(e){this.storage("modules_search",null),document.querySelectorAll('table.data thead input[type="search"]').forEach(function(e){e.value=""}),document.querySelectorAll("table.data tbody tr[style]").forEach(function(e){e.removeAttribute("style")}),(e=document.querySelector('div.content-header input[type="search"]')).value="",e.focus()},this.unload=function(){this.storage("modules_search",this.storage("modules_search"))},this.storage=function(e,t){if(null===t)localStorage.removeItem(e),sessionStorage.removeItem(e);else{if(void 0===t)return localStorage.getItem(e)||sessionStorage.getItem(e);localStorage.setItem(e,t),sessionStorage.setItem(e,t)}}};"function"==typeof self.addEventListener&&(self.addEventListener("load",modules.start.bind(modules)),self.addEventListener("beforeunload",modules.unload.bind(modules)));